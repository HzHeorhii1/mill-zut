package org.example;

import java.util.List;
import java.util.Scanner;

public class Main {
    public static void main(String[] args) {
        GameState gra = new MorrisState();
        GameSearchAlgorithm alg = new MinimaxAlgorithm(); // Або ваш конкретний алгоритм пошуку
        Scanner scanner = new Scanner(System.in);

        while (!gra.isWinTerminal() && !gra.isNonWinTerminal()) {
            System.out.println(gra);

            long[] nodeCounts = new long[6]; // Наприклад, до 10 рівнів
            expand(game, nodeCounts, 0);

            for (int i = 0; i < nodeCounts.length; i++) {
                System.out.println("Рівень " + i + ": " + nodeCounts[i] + " вузлів");
            }

            // Хід гравця
            System.out.println("Ваш хід. Введіть назву руху: ");
            String ruch = scanner.nextLine();

            List<GameState> children = gra.generateChildren();
            boolean validMove = false;

            for (GameState c : children) {
                if (ruch.equals(c.getMoveName())) {
                    gra = c;
                    validMove = true;
                    break;
                }
            }

            if (!validMove) {
                System.out.println("Невірний хід! Спробуйте ще раз.");
                continue;
            }

            if (gra.isWinTerminal() || gra.isNonWinTerminal()) {
                break;
            }

            // Хід комп'ютера
            children = gra.generateChildren();
            alg.setInitial(gra);
            alg.execute();

            String computerMove = alg.getFirstBestMove();
            System.out.println("Хід комп'ютера: " + computerMove);

            for (GameState c : children) {
                if (computerMove.equals(c.getMoveName())) {
                    gra = c;
                    break;
                }
            }
        }

        if (gra.isWinTerminal()) {
            System.out.println("Гра закінчена: перемога!");
        } else if (gra.isNonWinTerminal()) {
            System.out.println("Гра закінчена: нічия!");
        }
    }

    public static void expand(GameState s, long[] v, int d) {
            if (d >= v.length)
                return;
            for (GameState t : s.generateChildren()) {
                v[d]++;
                expand(t, v, d + 1);
            }
        }

}
